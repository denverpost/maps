<!DOCTYPE html>
<html>

<head>
    <meta charset=utf-8 />
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <title>Tornadoes in Colorado, 1950-2015</title>
    <link rel="canonical" href="http://extras.denverpost.com/charts/sports/rockies/historical-record/index.html" />
    <link rel="shortcut icon" href="http://extras.mnginteractive.com/live/media/favIcon/dpo/favicon.ico" type="image/x-icon" />
    <!-- STYLE SHEETS -->
    <link rel="stylesheet" href="css/foundation.css">
    <link rel="stylesheet" href="css/normalize.css">
    <link href='https://api.mapbox.com/mapbox.js/v2.4.0/mapbox.css' rel='stylesheet' />
    <link href='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/MarkerCluster.css' rel='stylesheet' />
    <link href='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/MarkerCluster.Default.css' rel='stylesheet' />
    <link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-minimap/v1.0.0/Control.MiniMap.css' rel='stylesheet' />
    <link href="css/styles.css" rel="stylesheet"/>
    <!-- SCRIPTS -->
    <script src="js/vendor/jquery.js"></script>
    <script src="js/vendor/modernizr.js"></script>
    <script src="js/foundation/foundation.js"></script>
    <script src="js/foundation/foundation.reveal.js"></script>
    <script src='https://api.mapbox.com/mapbox.js/v2.4.0/mapbox.js'></script>
    <script src='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/leaflet.markercluster.js'></script>
    <script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-minimap/v1.0.0/Control.MiniMap.js'></script>
    <script src="js/tablesorter.js"></script>
    <style>
    body {
        background-color: #fafafa;
    }
    </style>
</head>

<body>
    <div class="row">
        <div class="large-10 large-centered columns">
            <h1>Colorado Tornadoes: By the Numbers</h1>
        </div>
    </div><a href="#" data-reveal-id="myModal">Click Me For A Modal</a>
    <div id="myModal" class="reveal-modal" data-reveal aria-labelledby="modalTitle" aria-hidden="true" role="dialog">
        <h4 style="font-weight: bold; text-align: center;">Fujita Tornado Damage Scale</h4>
        <p class="f-scale-underline"><strong>F0</strong> &bull; <em>wind speed < 73 mph (65-85 mph)*</em></p>
        <p class="f-scale-text">Light damage. Some damage to chimneys; branches broken off trees; shallow-rooted trees pushed over; sign boards damaged.</p>
        <p class="f-scale-underline"><strong>F1</strong> &bull; <em> wind speed 73-112 mph (86-110 mph)</em></p>
        <p class="f-scale-text">Moderate damage. Peels surface off roofs; mobile homes pushed off foundations or overturned; moving autos blown off roads.</p>
        <p class="f-scale-underline"><strong>F2</strong> &bull; <em>wind speed 113-157 mph (111-135 mph)</em></p>
        <p class="f-scale-text">Considerable damage. Roofs torn off frame houses; mobile homes demolished; boxcars overturned; large trees snapped or uprooted; light-object missiles generated; cars lifted off ground.</p>
        <p class="f-scale-underline"><strong>F3</strong> &bull; <em>wind speed 158-206 mph (136-165 mph)</em></p>
        <p class="f-scale-text">Severe damage. Roofs and some walls torn off well-constructed houses; trains overturned; most trees in forest uprooted; heavy cars lifted off the ground and thrown.</p>
        <p class="f-scale-underline"><strong>F4</strong> &bull; <em>wind speed 207-260 mph 166-200 mph</em></p>
        <p class="f-scale-text">Devastating damage. Well-constructed houses leveled; structures with weak foundations blown away some distance; cars thrown and large missiles generated.</p>
        <p class="f-scale-underline"><strong>F5</strong> &bull; <em>wind speed 261-318 mph (> 200 mph)</em></p>
        <p class="f-scale-text">Incredible damage. Strong frame houses leveled off foundations and swept away; automobile-sized missiles fly through the air in excess of 100 meters (109 yds); trees debarked; incredible phenomena will occur.</p>
        <em>* <a href="http://www.spc.noaa.gov/faq/tornado/ef-scale.html">Enhanced Fujita scale</a> measurement. The Enhanced Fujita scale replaced the Fujita scale in 2007 to survey tornado damage.</em>
        <a class="close-reveal-modal" aria-label="Close">&#215;</a>
    </div>
    <h3>Injuries, Fatalities Since 1950</h3>
    <table class="simple tablesorter" id="injuries">
        <thead>
            <tr>
                <th>Rank</th>
                <th>State</th>
                <th>Injuries</th>
                <th>Fatalities</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>1</td>
                <td>Texas</td>
                <td>11,075</td>
                <td>634</td>
            </tr>
            <tr>
                <td>2</td>
                <td>Alabama</td>
                <td>9,221</td>
                <td>789</td>
            </tr>
            <tr>
                <td>3</td>
                <td> Mississippi</td>
                <td>8,478</td>
                <td>666</td>
            </tr>
            <tr>
                <td>4</td>
                <td> Oklahoma</td>
                <td>6,414</td>
                <td>470</td>
            </tr>
            <tr>
                <td>5</td>
                <td> Arkansas</td>
                <td>5,713</td>
                <td>409</td>
            </tr>
            <tr>
                <td>6</td>
                <td> Ohio</td>
                <td>5,276</td>
                <td>260</td>
            </tr>
            <tr>
                <td>7</td>
                <td> Indiana</td>
                <td>4,985</td>
                <td>309</td>
            </tr>
            <tr>
                <td>8</td>
                <td> Missouri</td>
                <td>4,937</td>
                <td>426</td>
            </tr>
            <tr>
                <td>9</td>
                <td> Illinois</td>
                <td>4,729</td>
                <td>228</td>
            </tr>
            <tr>
                <td>10</td>
                <td> Tennessee</td>
                <td>4,528</td>
                <td>371</td>
            </tr>
            <tr>
                <td>33</td>
                <td> Colorado</td>
                <td>285</td>
                <td>5</td>
            </tr>
        </tbody>
    </table>
    <p><em>Ranked by injuries</em></p>
    <table class="simple tablesorter" id="square-miles">
        <thead>
            <tr>
                <th>County</th>
                <th>Count</th>
                <th>Count per
                    <br>100 sq mi</th>
                <th>Injuries</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Weld</td>
                <td>264</td>
                <td>6.6</td>
                <td>92</td>
            </tr>
            <tr>
                <td>Adams</td>
                <td>170</td>
                <td>14.6</td>
                <td>43</td>
            </tr>
            <tr>
                <td>Washington</td>
                <td>147</td>
                <td>5.8</td>
                <td>10</td>
            </tr>
            <tr>
                <td>Elbert</td>
                <td>122</td>
                <td>6.6</td>
                <td>0</td>
            </tr>
            <tr>
                <td>Lincoln</td>
                <td>101</td>
                <td>3.9</td>
                <td>15</td>
            </tr>
            <tr>
                <td>Kit Carson</td>
                <td>99</td>
                <td>4.6</td>
                <td>14</td>
            </tr>
            <tr>
                <td>Arapahoe</td>
                <td>89</td>
                <td>11.2</td>
                <td>4</td>
            </tr>
            <tr>
                <td>El Paso</td>
                <td>88</td>
                <td>4.1</td>
                <td>19</td>
            </tr>
            <tr>
                <td>Yuma</td>
                <td>83</td>
                <td>3.5</td>
                <td>14</td>
            </tr>
            <tr>
                <td>Prowers</td>
                <td>82</td>
                <td>5.0</td>
                <td>17</td>
            </tr>
            <tr>
                <td>Baca</td>
                <td>80</td>
                <td>3.1</td>
                <td>4</td>
            </tr>
            <tr>
                <td>Kiowa</td>
                <td>80</td>
                <td>4.5</td>
                <td>2</td>
            </tr>
            <tr>
                <td>Logan</td>
                <td>79</td>
                <td>4.3</td>
                <td>4</td>
            </tr>
            <tr>
                <td>Cheyenne</td>
                <td>73</td>
                <td>4.1</td>
                <td>5</td>
            </tr>
            <tr>
                <td>Morgan</td>
                <td>71</td>
                <td>5.5</td>
                <td>0</td>
            </tr>
            <tr>
                <td>Douglas</td>
                <td>61</td>
                <td>7.3</td>
                <td>6</td>
            </tr>
            <tr>
                <td>Bent</td>
                <td>42</td>
                <td>2.8</td>
                <td>8</td>
            </tr>
            <tr>
                <td>Phillips</td>
                <td>40</td>
                <td>5.8</td>
                <td>1</td>
            </tr>
            <tr>
                <td>Sedgwick</td>
                <td>32</td>
                <td>5.8</td>
                <td>10</td>
            </tr>
            <tr>
                <td>Larimer</td>
                <td>30</td>
                <td>1.2</td>
                <td>0</td>
            </tr>
            <tr>
                <td>Las Animas</td>
                <td>30</td>
                <td>0.6</td>
                <td>1</td>
            </tr>
            <tr>
                <td>Otero</td>
                <td>24</td>
                <td>1.9</td>
                <td>0</td>
            </tr>
            <tr>
                <td>Pueblo</td>
                <td>18</td>
                <td>0.8</td>
                <td>0</td>
            </tr>
            <tr>
                <td>Alamosa</td>
                <td>16</td>
                <td>2.2</td>
                <td>0</td>
            </tr>
            <tr>
                <td>Crowley</td>
                <td>16</td>
                <td>2.0</td>
                <td>0</td>
            </tr>
            <tr>
                <td>Denver</td>
                <td>16</td>
                <td>10.5</td>
                <td>13</td>
            </tr>
            <tr>
                <td>Jefferson</td>
                <td>13</td>
                <td>1.7</td>
                <td>0</td>
            </tr>
            <tr>
                <td>Boulder</td>
                <td>11</td>
                <td>1.5</td>
                <td>0</td>
            </tr>
            <tr>
                <td>Mesa</td>
                <td>10</td>
                <td>0.3</td>
                <td>0</td>
            </tr>
        </tbody>
    </table>
    <h3>Tornado Locations</h3>
    <p>The map shows the approximate starting location of all tornadoes rated F1 or higher from 1950-2015.
        <br><em>Click/unclick checkboxes below to show only certain categories; click map markers for details; markers are grouped depending on map zoom level: hover over group marker for area, click to zoom in.</em></p>
    <form id='fScaleFilter'>
        <div id="legend-container">
            <p class="legend"><strong>Show only certain categories of storms:</strong>
                <br><em>&#9733; indicates injuries/fatalities</em></p>
            <div class="legend" id="f-1">
                <label>
                    <input type='checkbox' name='filters' onclick='showTornadoes();' value="1" checked>F1
                </label>
            </div>
            <div class="legend" id="f-2">
                <label>
                    <input type='checkbox' name='filters' onclick='showTornadoes();' value="2" checked> F2
                </label>
            </div>
            <div class="legend" id="f-3">
                <label>
                    <input type='checkbox' name='filters' onclick='showTornadoes();' value="3" checked> F3
                </label>
            </div>
            <div class="legend" id="f-4">
                <label>
                    <input type='checkbox' name='filters' onclick='showTornadoes();' value="4" checked> F4
                </label>
            </div>
        </div>
    </form>
    <div id="map"></div>
    <script>
    L.mapbox.accessToken = 'pk.eyJ1Ijoia2hhbW0tZGVudmVycG9zdCIsImEiOiJjaWZoMThvYWxhcHZtc3htN25sZWhnNGkzIn0.xPsTe8f7I19lj2xCFQ1Ciw';
    // Here we don't use the second argument to map, since that would automatically
    // load in non-clustered markers from the layer. Instead we add just the
    // backing tileLayer, and then use the featureLayer only for its data.
    var map = L.mapbox.map('map', 'mapbox.streets')
        .setView([39.707083, -104.65684], 9)
        //.addLayer(L.mapbox.tileLayer('mapbox.streets'))
        .on('ready', function() {
            new L.Control.MiniMap(L.mapbox.tileLayer('mapbox.streets'))
                .addTo(map);
        });

    // Disable drag and zoom handlers
    //map.dragging.disable();
    //map.touchZoom.disable();
    //map.doubleClickZoom.disable();
    //map.scrollWheelZoom.disable();

    var overlays = L.layerGroup().addTo(map);

    // we create the 'layers' variable outside of the on('ready' callback
    // so that it can be accessible in the showStations function. Otherwise,
    // JavaScript scope would prevent you from accessing it.
    var layers;

    // Since featureLayer is an asynchronous method, we use the `.on('ready'`
    // call to only use its marker data once we know it is actually loaded.
    L.mapbox.featureLayer()
        //.loadURL('json_test.js')
        .loadURL('js/colorado_tornadoes_final_geojson.js')
        .on('ready', function(e) {
            layers = e.target;
            //console.log(e);
            showTornadoes();
            this.eachLayer(function(marker) {
                if (marker.toGeoJSON().properties.fScale == 1 && marker.toGeoJSON().properties.injuries == 0) {
                    marker.setIcon(L.mapbox.marker.icon({
                        'marker-color': '#4863a1',
                        'marker-size': 'medium'
                    }))
                } else if (marker.toGeoJSON().properties.fScale == 1 && marker.toGeoJSON().properties.injuries != 0) {
                    marker.setIcon(L.mapbox.marker.icon({
                        'marker-color': '#4863a1',
                        'marker-symbol': 'star',
                        'marker-size': 'medium'
                    }))
                } else if (marker.toGeoJSON().properties.fScale == 2 && marker.toGeoJSON().properties.injuries == 0) {
                    marker.setIcon(L.mapbox.marker.icon({
                        'marker-color': '#8648a1',
                        'marker-size': 'medium'
                    }))
                } else if (marker.toGeoJSON().properties.fScale == 2 && marker.toGeoJSON().properties.injuries != 0) {
                    marker.setIcon(L.mapbox.marker.icon({
                        'marker-color': '#8648a1',
                        'marker-symbol': 'star',
                        'marker-size': 'medium'
                    }))
                } else if (marker.toGeoJSON().properties.fScale == 3 && marker.toGeoJSON().properties.injuries == 0) {
                    marker.setIcon(L.mapbox.marker.icon({
                        'marker-color': '#a14863',
                        'marker-size': 'medium'
                    }))
                } else if (marker.toGeoJSON().properties.fScale == 3 && marker.toGeoJSON().properties.injuries != 0) {
                    marker.setIcon(L.mapbox.marker.icon({
                        'marker-color': '#a14863',
                        'marker-symbol': 'star',
                        'marker-size': 'medium'
                    }))
                } else {
                    marker.setIcon(L.mapbox.marker.icon({
                        'marker-color': '#000000',
                        'marker-size': 'medium'
                    }));
                };
            });
        });
    var filters = document.getElementById('fScaleFilter').filters;

    // There are many ways to filter data. Mapbox.js has the .setFilter method,
    // but it only applies to L.mapbox.featureLayer layers, and that isn't what
    // we're creating - we're making marker groups in a MarkerClusterGroup layer.
    // Thus we distill filtering down to its essential part: an 'if' statement
    // in a loop.
    function showTornadoes() {
        // first collect all of the checked boxes and create an array of strings
        // like ['green', 'blue']
        var list = [];
        for (var i = 0; i < filters.length; i++) {
            if (filters[i].checked) list.push(+filters[i].value);
            //console.log(i);
        }
        //console.log(list);
        // then remove any previously-displayed marker groups
        overlays.clearLayers();
        // create a new marker group
        var clusterGroup = new L.MarkerClusterGroup().addTo(overlays);
        // and add any markers that fit the filtered criteria to that group.
        layers.eachLayer(function(layer) {
            if (list.indexOf(+layer.feature.properties.fScale) !== -1) {
                layer.bindPopup('<strong>' + layer.feature.properties.fullDate + ' &bull; ' + 'F-' + layer.feature.properties.fScale + '<br>' + layer.feature.properties.countyName + ' County<br>' + '</strong><hr class="popup">' + '<br>Injuries: ' + layer.feature.properties.injuries + '<br>Fatalities: ' + layer.feature.properties.fatalities + '<br>Length: ' + layer.feature.properties.lengthMiles + ' miles' + '<br>Width: ' + layer.feature.properties.widthYards + ' yards' + '<br>Time: ' + layer.feature.properties.fullTime);
                clusterGroup.addLayer(layer);
            }
            //console.log(layer);
            //console.log(layer.feature.properties.fScale);
        });
    };
    </script>
    <script>
    $(document).ready(function() {
        $.tablesorter.addParser({
            id: 'thousands',
            is: function(s) {
                return false;
            },
            format: function(s) {
                s = s.replace(/\,/g, "");
                s = parseFloat(s);
                return s;
                return s.replace(/\,/g, '');
            },
            type: 'numeric'
        });
        $("table#injuries").tablesorter({
            headers: {
                2: {
                    sorter: 'thousands'
                }
            }
        });
        $("table#f-scale").tablesorter({
            headers: {
                1: {
                    sorter: 'thousands'
                },
                2: {
                    sorter: 'thousands'
                }
            }
        });
        $("table#square-miles").tablesorter({
            headers: {
                5: {
                    sorter: 'thousands'
                }
            }
        })
    });
    </script>
    <!-- <script>
    $(document).ready(function() {
        $.tablesorter.addParser({
            id: 'thousands',
            is: function(s) {
                return false;
            },
            format: function(s) {
                s = s.replace(/\,/g, "");
                s = parseFloat(s);
                return s;
                return s.replace(/\,/g, '');
            },
            type: 'numeric'
        });
        $("table#injuries").tablesorter({
            headers: {
                2: {
                    sorter: 'thousands'
                }
            }
        });
        $("table#f-scale").tablesorter({
            headers: {
                1: {
                    sorter: 'thousands'
                },
                2: {
                    sorter: 'thousands'
                }
            }
        });
        $("table#square-miles").tablesorter({
            headers: {
                5: {
                    sorter: 'thousands'
                }
            }
        })
    });
    </script> -->
    <!-- <script>
        $(document).ready(function() {
            $("#myTable").tablesorter();
            $("#myModal").foundation();
        });
        </script> -->
    <!-- LEAFLET SCRIPT -->
    <script>
    $(document).ready(function() {
        $(document).foundation();
    });
    </script>
</body>

</html>
